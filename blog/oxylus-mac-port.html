<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Porting Oxylus To MacOS | Hatrickek</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hatrickek.github.io/blog/oxylus-mac-port"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Porting Oxylus To MacOS | Hatrickek"><meta data-rh="true" name="description" content="My Russian friend Yugin had a brilliant idea in the middle of the night. His plan was to build Oxylus on his MacBook in order to see how many errors and problems he would encounter or if the build would go smoothly."><meta data-rh="true" property="og:description" content="My Russian friend Yugin had a brilliant idea in the middle of the night. His plan was to build Oxylus on his MacBook in order to see how many errors and problems he would encounter or if the build would go smoothly."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-03-29T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/Hatrickek"><meta data-rh="true" property="article:tag" content="blog"><link data-rh="true" rel="icon" href="/img/logo.webp"><link data-rh="true" rel="canonical" href="https://hatrickek.github.io/blog/oxylus-mac-port"><link data-rh="true" rel="alternate" href="https://hatrickek.github.io/blog/oxylus-mac-port" hreflang="en"><link data-rh="true" rel="alternate" href="https://hatrickek.github.io/blog/oxylus-mac-port" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Hatrickek RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Hatrickek Atom Feed"><link rel="stylesheet" href="/assets/css/styles.9b33f45f.css">
<link rel="preload" href="/assets/js/runtime~main.e65cbc70.js" as="script">
<link rel="preload" href="/assets/js/main.46237277.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="Hatrickek Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="Hatrickek Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Hatrickek</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Hatrickek" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/oxylus-mac-port">Porting Oxylus To MacOS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/oxylus-first-game">Creating A Game With Oxylus</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/oxylus-engine-intro">Oxylus Engine - Introduction</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/why-i-created">Why I Created This Blog</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Porting Oxylus To MacOS</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-03-29T00:00:00.000Z" itemprop="datePublished">March 29, 2023</time> Â· <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Hatrickek" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/89982837?v=4" alt="Hatrickek"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Hatrickek" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Hatrickek</span></a></div></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>My Russian friend Yugin had a brilliant idea in the middle of the night. His plan was to build Oxylus on his MacBook in order to see how many errors and problems he would encounter or if the build would go smoothly.<br>
<!-- -->Oh boy, were we clueless as hell.</p><blockquote><p>Oh and if you think modern C++ is cross platform or just like to use the &quot;modern&quot; std features it has, this blog might change your thoughts on those topics ðŸ˜…. <a href="https://gist.github.com/bkaradzic/2e39896bc7d8c34e042b" target="_blank" rel="noopener noreferrer">Also that</a>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dependencies">Dependencies<a href="#dependencies" class="hash-link" aria-label="Direct link to Dependencies" title="Direct link to Dependencies">â€‹</a></h2><p>He cloned the repository and tried to build it, but encountered the first problem with dependencies. Managing dependencies in C++ is disliked by everyone, and writing CMake scripts to manage them is not a favorite task. However, some people have created alternatives like <a href="https://premake.github.io/" target="_blank" rel="noopener noreferrer">Premake</a>, which uses Lua and simple syntax to make it easier. I used Premake until I considered porting Oxylus to Mac, at which point I stopped using it because it was limiting users to specific tools (i.e., Visual Studio on Windows or XCode on Mac), which were not preferred. Instead, I rewrote my old CMake scripts and added small dependencies as submodules, which automated the build process. Using this approach, these modules were easily buildable as cross-platform (at least for Mac and Windows).
I rewrote my old CMake scripts, added the small dependencies as submodules, and automated the build process. This way, the modules were easily buildable as cross-platform for at least Mac and Windows.<br>
<!-- -->I had a couple more dependencies to add as submodules: PhysX, KTX, and Vulkan. However, PhysX was a very challenging library to manage, so I decided to abandon it altogether and switch to <a href="https://github.com/jrouwe/JoltPhysics" target="_blank" rel="noopener noreferrer">Jolt</a> in the future. <a href="https://github.com/KhronosGroup/KTX-Software" target="_blank" rel="noopener noreferrer">KTX</a> had a similar issue; the repository contained six different projects, making it difficult to add as a submodule. Yugin suggested a solution where we could download the repository as a shallow zip copy and extract it into the vendor directory. This worked perfectly and left me with just one last dependency to make cross-platform: Vulkan. Luckily, it was the easiest to build since CMake already had functions specifically for Vulkan, such as <a href="https://cmake.org/cmake/help/latest/module/FindVulkan.html" target="_blank" rel="noopener noreferrer">FindVulkan</a>.<br>
<!-- -->Now the project was in theory ready to build on all platforms.<br>
<!-- -->Surely these were the only problems, right?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="modern-c">Modern C++<a href="#modern-c" class="hash-link" aria-label="Direct link to Modern C++" title="Direct link to Modern C++">â€‹</a></h2><p>Well, I could only dream... The first error he encountered was related to the use of the not-so-modern std function <code>std::ranges</code>. Now seeing this made me question, how that was an issue. After a quick 2-minute Google search, I discovered that it wasn&#x27;t even <a href="https://developer.apple.com/forums/thread/719896" target="_blank" rel="noopener noreferrer">supported on mac clang</a>! Luckily, I hadn&#x27;t used it extensively, so I rewrote the code that I had written using it, such as i.e. <code>ranges::view</code>, <code>ranges::find_if</code> etc.<br>
<!-- -->The next problem was similar. Now it was from <code>std::views</code>! Again <a href="https://stackoverflow.com/questions/73628848/is-the-stdviews-namespace-not-available-in-xcodes-c?rq=1" target="_blank" rel="noopener noreferrer">the same issue</a>. I had to rewrite the code I have written with it, but I thought that would be the end of it. Surely the standard library wasn&#x27;t that anti-cross-platform? Well you would be wrong.<br>
<!-- -->I encountered the infamous <code>std::format</code> as my next enemy. After another quick Google search, I discovered that it was a big problem for other platforms as well, and that people had already created a much better alternative called <a href="https://github.com/fmtlib/fmt" target="_blank" rel="noopener noreferrer">fmt</a>. Therefore, I had to add another dependency to my project for a feature that already existed in the standard library but was still not cross-platform even after two years since its release. How NICE!
These were all the problems I had with the standard library. Thankfully, I didn&#x27;t go crazy with modern C++ otherwise, I&#x27;m sure this list would have had gone a lot longer.</p><p>My next and final challenge was Vulkan. Since Vulkan is relatively cross-platform and has verbose error messages, it was relatively easy to run it on Mac with the MoltenVK layer. I had to enable a few layers and extensions, and then it should have worked... right? Unfortunately, I encountered a timeout error on some command buffer submission in MoltenVK. After some investigation, I discovered that I had forgotten to remove some semaphores in my composite pipeline. Once I removed them, it finally worked! However, it took a few sleepless nights and taught me a valuable lesson...</p><p><img loading="lazy" src="https://cdn.discordapp.com/attachments/1022588581237248060/1090745806765699242/Annotation_2023-03-29_235941.png" alt="Result" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/blog">blog</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/oxylus-first-game"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Creating A Game With Oxylus</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dependencies" class="table-of-contents__link toc-highlight">Dependencies</a></li><li><a href="#modern-c" class="table-of-contents__link toc-highlight">Modern C++</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/Hatrickek" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Hatrickek, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e65cbc70.js"></script>
<script src="/assets/js/main.46237277.js"></script>
</body>
</html>